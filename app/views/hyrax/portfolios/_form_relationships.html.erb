<div class="form-group mt-4">
  <h4>Version & Derivative Relationships</h4>
  <p class="help-text">Link this portfolio to previous versions, newer versions, performances, exhibitions, and derivative works</p>

  <!-- Previous Versions -->
  <div class="relationship-section" data-behavior="previous-version-manager" data-relationship="previous-version">
    <h5 class="mt-3">Previous Versions</h5>
    <p class="small text-muted">Earlier versions that this work replaces or builds upon</p>

    <div class="form-inline mb-2">
      <input type="text"
             class="form-control relationship-autocomplete"
             placeholder="Search for previous version..."
             data-relationship="previous-version"
             autocomplete="off" />
      <button type="button" class="btn btn-outline-secondary btn-sm ml-2" data-behavior="add-relationship">
        <i class="fa fa-plus"></i> Add
      </button>
    </div>

    <div class="well previous-version-list">
      <table class="table table-sm" data-param-key="previous_version" id="previous_version">
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Newer Versions -->
  <div class="relationship-section mt-4" data-behavior="newer-version-manager" data-relationship="newer-version">
    <h5>Newer Versions</h5>
    <p class="small text-muted">Later versions that replace or extend this work</p>

    <div class="form-inline mb-2">
      <input type="text"
             class="form-control relationship-autocomplete"
             placeholder="Search for newer version..."
             data-relationship="newer-version"
             autocomplete="off" />
      <button type="button" class="btn btn-outline-secondary btn-sm ml-2" data-behavior="add-relationship">
        <i class="fa fa-plus"></i> Add
      </button>
    </div>

    <div class="well newer-version-list">
      <table class="table table-sm" data-param-key="newer_version" id="newer_version">
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Performances -->
  <div class="relationship-section mt-4" data-behavior="performance-manager" data-relationship="performance">
    <h5>Performances</h5>
    <p class="small text-muted">Performance records or documentation of this work being performed</p>

    <div class="form-inline mb-2">
      <input type="text"
             class="form-control relationship-autocomplete"
             placeholder="Search for performance..."
             data-relationship="performance"
             autocomplete="off" />
      <button type="button" class="btn btn-outline-secondary btn-sm ml-2" data-behavior="add-relationship">
        <i class="fa fa-plus"></i> Add
      </button>
    </div>

    <div class="well performance-list">
      <table class="table table-sm" data-param-key="performance" id="performance">
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Exhibitions -->
  <div class="relationship-section mt-4" data-behavior="exhibition-manager" data-relationship="exhibition">
    <h5>Exhibitions</h5>
    <p class="small text-muted">Exhibition records where this work was displayed</p>

    <div class="form-inline mb-2">
      <input type="text"
             class="form-control relationship-autocomplete"
             placeholder="Search for exhibition..."
             data-relationship="exhibition"
             autocomplete="off" />
      <button type="button" class="btn btn-outline-secondary btn-sm ml-2" data-behavior="add-relationship">
        <i class="fa fa-plus"></i> Add
      </button>
    </div>

    <div class="well exhibition-list">
      <table class="table table-sm" data-param-key="exhibition" id="exhibition">
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Derivative Works -->
  <div class="relationship-section mt-4" data-behavior="derivative-manager" data-relationship="derivative">
    <h5>Derivative Works</h5>
    <p class="small text-muted">Works derived from or adapted from this work</p>

    <div class="form-inline mb-2">
      <input type="text"
             class="form-control relationship-autocomplete"
             placeholder="Search for derivative work..."
             data-relationship="derivative"
             autocomplete="off" />
      <button type="button" class="btn btn-outline-secondary btn-sm ml-2" data-behavior="add-relationship">
        <i class="fa fa-plus"></i> Add
      </button>
    </div>

    <div class="well derivative-list">
      <table class="table table-sm" data-param-key="derivative" id="derivative">
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<script type="text/template" id="tmpl-relationship">
  <tr class="relationship-row" data-relationship="{{= relationship }}" data-work-id="{{= id }}">
    <td>
      <strong>{{= title }}</strong>
      <input type="hidden"
             name="portfolio[related_members_attributes][{{= index }}][id]"
             value="{{= id }}" />
      <input type="hidden"
             name="portfolio[related_members_attributes][{{= index }}][relationship]"
             value="{{= relationship }}" />
      <input type="hidden"
             name="portfolio[related_members_attributes][{{= index }}][_destroy]"
             value="false"
             class="destroy-field" />
    </td>
    <td class="text-right">
      <button type="button"
              class="btn btn-danger btn-sm"
              data-behavior="remove-relationship">
        <i class="fa fa-trash"></i> Remove
      </button>
    </td>
  </tr>
</script>

<style>
.relationship-section {
  border-left: 3px solid #dee2e6;
  padding-left: 1rem;
}

.relationship-autocomplete {
  min-width: 300px;
}

.well {
  min-height: 50px;
  background-color: #f8f9fa;
  padding: 1rem;
  border-radius: 0.25rem;
}

.relationship-row {
  background-color: white;
}
</style>
