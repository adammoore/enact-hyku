<% if @presenter.tk_labels.present? %>
  <div class="alert alert-info tk-label-notice mb-4">
    <h4><i class="fa fa-info-circle"></i> Traditional Knowledge Notice</h4>

    <p class="mb-3">
      This work is marked with Traditional Knowledge (TK) Labels developed by Indigenous communities
      to manage their intellectual property and cultural heritage.
    </p>

    <% @presenter.tk_labels.each do |label| %>
      <% label_info = TkLabelService.display_info(label) %>
      <div class="tk-label-item mb-3 p-3 bg-light border-left border-primary">
        <strong class="d-block mb-1"><%= label %>: <%= label_info[:name] %></strong>
        <p class="mb-2"><%= label_info[:description] %></p>
        <a href="<%= label_info[:url] %>" target="_blank" rel="noopener" class="btn btn-sm btn-outline-primary">
          Learn more about this label <i class="fa fa-external-link"></i>
        </a>
      </div>
    <% end %>

    <% if @presenter.tk_attribution_requirement.present? %>
      <div class="mt-3 p-3 bg-warning-light border-left border-warning">
        <strong class="d-block mb-1"><i class="fa fa-exclamation-triangle"></i> Attribution Requirement:</strong>
        <p class="mb-0"><%= @presenter.tk_attribution_requirement %></p>
      </div>
    <% end %>

    <% permission_service = TkPermissionService.new(current_user, @presenter.model) %>
    <% unless permission_service.can_download? %>
      <div class="alert alert-warning mt-3 mb-0">
        <i class="fa fa-lock"></i>
        <strong>Download Restricted:</strong>
        <%= permission_service.download_denial_reason %>
      </div>
    <% end %>

    <hr>
    <p class="mb-0 small text-muted">
      These labels were developed by Indigenous communities to manage their intellectual
      property and cultural heritage. Learn more at
      <a href="https://localcontexts.org/labels/traditional-knowledge-labels/" target="_blank" rel="noopener">
        Local Contexts <i class="fa fa-external-link"></i>
      </a>.
    </p>
  </div>

  <style>
    .tk-label-notice {
      border-left: 5px solid #2C5282;
    }

    .tk-label-item {
      border-left-width: 3px !important;
    }

    .bg-warning-light {
      background-color: #fff3cd;
    }

    .border-warning {
      border-color: #ffc107 !important;
    }
  </style>
<% end %>
